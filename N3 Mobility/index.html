
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>N3TC Mobility</title>

    <!-- Sets initial viewport load and disables zooming	-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.39.1/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.39.1/mapbox-gl.css' rel='stylesheet' />



    <!-- Include the base Snap.js CSS -->
    <link rel="stylesheet" href="css/snap.css">

    <!-- Include the compiled Ratchet CSS -->
    <link rel="stylesheet" href="css/ratchet.css">

    <!-- Include the app CSS -->
    <link rel="stylesheet" href="css/app.css">

    <link rel="stylesheet" type="text/css" href="css/transition.min.css" />

    <link href="css/icomoon.css" rel="stylesheet" />





    <script type="text/javascript" src="js/maps-gbd.js"></script>
    <script type="text/javascript" src="js/zepto.min.js"></script>
    <script type="text/javascript" src="js/transition.min.js"></script>
    <script type="text/javascript" src="js/ratchet.js"></script>




    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }

        #map_canvas {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }

        .info {
            font-size: .6em;
            color: #FF6600;
            letter-spacing: 2px;
            padding-left: 5px;
        }

        #inputs,
        #errors,
        #directions {
            position: absolute;
            width: 33.3333%;
            max-width: 300px;
            min-width: 200px;
        }

        #inputs {
            z-index: 10;
            top: 10px;
            left: 10px;
        }

        #directions {
            z-index: 99;
            background: rgba(0,0,0,.8);
            top: 0;
            right: 0;
            bottom: 0;
            overflow: auto;
        }

        #errors {
            z-index: 8;
            opacity: 0;
            padding: 10px;
            border-radius: 0 0 3px 3px;
            background: rgba(0,0,0,.25);
            top: 90px;
            left: 10px;
        }

        #geocoder-container > div {
            min-width: 50%;
            margin-left: 25%;
        }

        .tweet {
            position: relative;
            padding: 10px 15px 10px 10px;
            border-bottom: 0px solid rgba(0, 0, 0, .1);
            font-size: 12pt;
        }

        .timePosted {
            font-size: 10pt;
            margin-left: 10px;
            padding: 4px;
            background-color: rgba(179, 180, 181, 0.0);
            border-bottom: 1px solid #ccc;
        }

        .interact {
            float: right;
            margin-top: -45px;
            font-size: 9pt;
            display: inline-grid;
            text-align: right;
            margin-right: 8px;
        }

        .marker {
            display: block;
            border: none;
            border-radius: 0px;
            cursor: pointer;
            padding: 0;
        }

        #fit {
            display: block;
            position: relative;
            margin: 0px auto;
            width: 50%;
            height: 40px;
            padding: 10px;
            border: none;
            border-radius: 3px;
            font-size: 12px;
            text-align: center;
            color: #fff;
            background: #ee8a65;
        }

        .poilist {
            margin-bottom: 0px;
            list-style: none;
            background-color: #fff;
            font-size: 12px;
            font-family: sans-serif;
            border-top: 10px solid #f1f1f1;
            border-bottom: 10px solid #f1f1f1;
            overflow: scroll;
        }

        .poiLi {
            border-top: 1px solid rgba(0, 0, 0, .1);
            margin: 10px 0px 10px 0px;
            padding: 5px;
        }

        .markerLbl {
            margin-top: 22px;
            font-size: 8pt;
            font-weight: bold;
            width: 110px;
            position: absolute;
            text-shadow: 1px 1px 0px #fff;
            color: #383838;
        }

        .markerLblPOI {
            margin-top: -20px;
            font-size: 8pt;
            font-weight: bold;
            width: 215px;
            position: absolute;
            text-align: right;
            margin-left: -110px;
        }

        .poiMenuDiv {
            background-size: contain;
            background-repeat: no-repeat;
            width: 38px;
            height: 40px;
        }
    </style>

    <script>
        $(document).ready(function () {
            console.log("document loaded");
            //get
            var localStoreUsr = localStorage.getItem("myUserName");
            var localStoreMail = localStorage.getItem("myEmail");
            var localStoreUPass = localStorage.getItem("myPassword");
            document.getElementById("n3tc-banner").innerHTML = localStoreUsr + '-' + localStoreMail + '-' + localStoreUPass;

            myLoc();
            //setTimeout(function () { $('.loading').hide(); }, 4000);

            //  $(".suggestions").click(function () {
            //  alert("Y");
            //  });

        });
    </script>

</head>
<body>

    <script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v3.1.1/mapbox-gl-directions.js'></script>
    <link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v3.1.1/mapbox-gl-directions.css' type='text/css' />

    <script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v2.1.0/mapbox-gl-geocoder.min.js'></script>
    <link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v2.1.0/mapbox-gl-geocoder.css' type='text/css' />
    <!-- SIDEBAR LEFT MENU -->
    <div class="snap-drawers">
        <div class="snap-drawer snap-drawer-left" id="left-drawer">
            <div id="menu">
                <div class="scrollable">
                    <ul>
                        <li id="li_page_home" class="active">
                            <span aria-hidden="true" class="icon-home-2"></span>
                            <a id="home" transition="side" href="#page_home" onclick="openPage(this.href)"> Home</a>
                        </li>
                        <li id="li_page_location_map_trip">
                            <span aria-hidden="true" class="icon-checkin"></span>
                            <a id="location-map-pnl" transition="side" href="#page_location_map_trip" onclick="openPageLocmap(this.href)">N3 Route</a>
                        </li>
                        <!--<li id="li_page_nearby">
                            <span aria-hidden="true" class="icon-chris-spittles-geo-location"></span>
                            <a id="nearby" transition="side" href="#page_location_map" onclick="openPageFly(this.href)"> N3 Route </a>
                        </li>-->
                        <li id="li_page_location_list">
                            <span aria-hidden="true" class="icon-maps"></span>
                            <a id="location-list" transition="side" href="#page_save_location" onclick="openPage(this.href)">Saved Trips</a>
                        </li>
                        <li id="li_page_save_location" onclick="">
                            <span aria-hidden="true" class="icon-bookmarks"></span>
                            <a id="save-location" transition="side" href="#page_add_location" onclick="openPage(this.href)">Add New Trip</a>
                        </li>
                        <li id="li_page_myaccount">
                            <span aria-hidden="true" class="icon-user"></span>
                            <a id="myaccount" transition="side" href="#page_myaccount" onclick="openPageAcc(this.href)">My Account</a>
                        </li>
                        <li id="li_page_twitter">
                            <span aria-hidden="true" class="icon-twitter"></span>
                            <a id="twitter" transition="side" href="#page_twitter" onclick="openPage(this.href)"> @N3Route </a>
                        </li>
                        <!-- <li id="li_page_twitter_fetch">
                             <span aria-hidden="true" class="icon-twitter"></span>
                             <a id="twitterFetch" transition="side" href="#page_twitter_fetch" onclick="openPage(this.href)"> Incident Alerts </a>
                         </li> -->
                        <li id="li_page_contact">
                            <span aria-hidden="true" class="icon-user"></span>
                            <a id="contact" transition="side" href="#page_contact" onclick="openPage(this.href)"> Contact</a>
                        </li>
                        <li id="li_page_poi">
                            <span aria-hidden="true" class="icon-maps"></span>
                            <a id="poi" transition="side" href="#page_location_list" onclick="openPage(this.href)"> POI</a>
                        </li>
                        <li id="mylocgps" onclick="myLoc()">
                            <span id="gpsout" style="padding: 10px 8px; font-size: 12px; line-height: 18px;">GPS</span>
                        </li>
                        <li id="copy" onclick="flytoZoom()">
                            N3 Toll Concession &copy; 2017
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- END SIDEBAR LEFT MENU -->
    <!-- SIDEBAR RIGHT MENU -->
    <div class="snap-drawer snap-drawer-right" id="right-drawer">
        <ul class="list">
            <li class="list-divider">Nearby Setting</li>
            <li onclick="toggleSrch()">
                <div class="fs1" aria-hidden="true" data-icon="&#xf220;"></div>
                Search Places
                <!--<div class="toggle-box">
                    <label for="toggle-nearby-distances" class="toggle-label">KM &nbsp;&nbsp; MIL</label>
                    <input type="checkbox" value="1" id="toggle-nearby-distances" class="toggle-control" />
                </div>-->
            </li>
            <li class="list-divider">Tools</li>
            <li id="directionsBtn" onclick="addDirections()">
                <div class="fs1" aria-hidden="true" data-icon="&#xf21b;"></div>
                Directions
                <div class="toggle-box">

                    <label for="toggle-directions-nav" class="toggle-label">ON &nbsp;&nbsp; OFF</label>
                    <input type="checkbox" value="1" id="toggle-directions-nav" class="toggle-control" />
                </div>
            </li>
            <li id="navBtn" onclick="navOn()">
                <div class="fs1" aria-hidden="true" data-icon="&#xf23a;"></div>
                Active Navigation
                <div class="toggle-box">
                    <label for="toggle-active-nav" class="toggle-label">ON &nbsp;&nbsp; OFF</label>
                    <input type="checkbox" value="1" id="toggle-active-nav" class="toggle-control" />
                </div>
            </li>
            <li id="voiceBtn" onclick="voiceOn()">
                <div class="fs1" aria-hidden="true" data-icon="&#xf18c;"></div>
                Voice Commands
                <div class="toggle-box">
                    <label for="toggle-voice-comm" class="toggle-label">ON &nbsp;&nbsp; OFF</label>
                    <input type="checkbox" value="1" id="toggle-voice-comm" class="toggle-control" />
                </div>
            </li>
            <li class="list-divider">Maps Layer Setting</li>
            <li>
                <div class="fs1" aria-hidden="true" data-icon="&#xf22a;"></div>
                Traffic Layer
                <div class="toggle-box">
                    <label for="toggle-traffic-layer" class="toggle-label">ON &nbsp;&nbsp; OFF</label>
                    <input type="checkbox" value="1" id="toggle-traffic-layer" class="toggle-control" />
                </div>
            </li>
            <li>
                <div class="fs1" aria-hidden="true" data-icon="&#xe05b;"></div>
                Weather Layer
                <div class="toggle-box">
                    <label for="toggle-weather-layer" class="toggle-label">ON &nbsp;&nbsp; OFF</label>
                    <input type="checkbox" value="1" id="toggle-weather-layer" class="toggle-control" />
                </div>
            </li>
            <li>
                <div class="fs1" aria-hidden="true" data-icon="&#x2b;"></div>
                <a id="poi2" transition="side" href="#page_poi" onclick="openPage(this.href)"></a>
                Places (POI)
                <div class="toggle-box">
                    <label for="toggle-transit-layer" class="toggle-label">ON &nbsp;&nbsp; OFF</label>
                    <input type="checkbox" value="1" id="toggle-transit-layer" class="toggle-control" />
                </div>
            </li>
            <li>
                <div class="fs1" aria-hidden="true" data-icon="&#xf2b4;"></div>
                Incidents Layer
                <div class="toggle-box">
                    <label for="toggle-panoramio-layer" class="toggle-label">ON &nbsp;&nbsp; OFF</label>
                    <input type="checkbox" value="1" id="toggle-panoramio-layer" class="toggle-control" />
                </div>
            </li>
            <li onclick="toggleMyGeocoder()">
                <div class="fs1" aria-hidden="true" data-icon="&#x2b;"></div>
                Nav Controls
                <div class="toggle-box">
                    <label for="toggle-bike-layer" class="toggle-label">ON &nbsp;&nbsp; OFF</label>
                    <input type="checkbox" value="1" id="toggle-bike-layer" class="toggle-control" />
                </div>
            </li>
        </ul>


    </div>
    <!-- END SIDEBAR RIGHT MENU -->
    <!-- MAIN -->
    <div id="content" class="snap-content">
        <!-- HEADER -->
        <header class="bar-title">
            <button class="button icon-list-2 toggle-left"></button>
            <h1 id="topHead" class="title">N3 Mobility</h1>
            <button class="button icon-uniF00F toggle-right" value="off"></button>
        </header>
        <!-- END HEADER -->
        <!-- CONTENT -->
        <div class="content">
            <!-- LOADING -->
            <div class="loading" align="center">
                <div class="circle"></div>
                <div class="circle1"></div>
            </div>
            <!-- END LOADING -->
            <!-- PAGE HOME -->
            <div id="page_home" data-role="page">
                <div class="wrapper">
                    <div class="slider" data-snap-ignore="true" style="height: 250px;">
                        <div id='mapSlider' data-snap-ignore="true" style="height: 100%;"></div>
                        <ul></ul>
                    </div>
                    <iframe frameborder="0" id="twtscroll" style=" width:100%; height:42px" src="twitter/index.html"></iframe>
                    <ul class="list">
                        <li>
                            <a id="twt-map" transition="side" href="#page_twitter" onclick="openPage(this.href)">
                                <div class="fs1" aria-hidden="true" data-icon="&#xf16a;"></div>
                                <strong>@N3Route</strong>
                                <span class="chevron"></span>
                            </a>
                        </li>
                        <li>
                            <a id="myacc" transition="side" href="#page_myaccount" onclick="openPageAcc(this.href)">
                                <div class="fs1" aria-hidden="true" data-icon="&#x62;"></div>
                                <strong>My Account</strong>
                                <span class="chevron"></span>
                            </a>
                        </li>
                        <li>
                            <a id="location-map" transition="side" href="#page_location_map_trip" onclick="openPageLocmap(this.href)">
                                <div class="fs1" aria-hidden="true" data-icon="&#xe008;"></div>
                                <strong>Expand Map</strong>
                                <span class="chevron"></span>
                            </a>
                        </li>
                        <li>
                            <a id="location-list" transition="side" href="#page_save_location" onclick="openPage(this.href)">
                                <div class="fs1" aria-hidden="true" data-icon="&#xf209;"></div>
                                <strong>Trip Planner</strong>
                                <span class="chevron"></span>
                            </a>
                        </li>

                        <li>
                            <a id="n3tc-banner-pg" transition="side" href="#page_test" onclick="openPage(this.href)">

                                <!-- <img src="images/n3tc_logo.png" width="100%" height="auto"/>-->
                                <span class="chevron"></span>
                            </a>
                        </li>
                    </ul>

                </div>
            </div>
            <!-- END PAGE HOME -->
            <!-- PAGE LOCATION LIST -->
            <div id="page_location_list" data-role="page" data-title="Page Location List">
                <div class="wrapper">
                    <ul id="list-category" class="list"></ul>
                </div>
            </div>
            <!-- END PAGE LOCATION LIST -->
            <!-- PAGE LOCATION LIST DETAIL -->
            <div id="page_detail" data-role="page" data-title="Page Detail">
                <div class="bar-standard bar-header-secondary">
                    <input type="search" id="search-list" placeholder="Search..">
                    <input type="hidden" id="category-id">
                </div>
                <div class="wrapper-bar">
                    <ul id="list-detail" class="list"></ul>
                </div>
            </div>
            <!-- END PAGE LOCATION LIST DETAIL -->
            <!-- PAGE NEARBY -->
            <div id="page_nearby" data-role="page" data-title="Page Nearby">
                <div id="nearby-wrapper" class="wrapper">


                    <ul id="list-nearby" class="list"></ul>

                </div>
            </div>
            <!-- END PAGE NEARBY -->
            <!-- PAGE CONTACT  -->
            <div id="page_contact" data-role="page" data-title="Page Contact">
                <div class="wrapper">
                    <ul id="n3-contact" class="list"><li>[ contact ]</li></ul>
                </div>
            </div>
            <!--END PAGE CONTACT  -->
            <!-- PAGE TEST  -->
            <div id="page_test" data-role="page" data-title="Page Test">
                <div class="wrapper">

                    <ul class="list">
                        <li>
                            <div id="n3tc-banner"></div>
                        </li>
                    </ul>
                    <iframe frameborder="0" id="crypt" scrolling="auto" height="300" style=" width:100%;" src="assets/simpleget.html"></iframe>
                </div>
            </div>
            <!--END PAGE TEST  -->
            <!-- PAGE MYACCOUNT -->
            <div id="page_myaccount" data-role="page" data-title="Page My Account">
                <div class="wrapper">
                    <iframe frameborder="0" id="frameForm" scrolling="yes" style=" width:100%;" src="assets/login.html"></iframe>
                </div>
            </div>
            <!-- END PAGE MYACCOUNT -->
            <!-- PAGE Accounts -->
            <div id="page_accounts" data-role="page" data-title="Page Accounts">
                <div class="wrapper">

                </div>
            </div>
            <!-- END PAGE Accounts -->
            <!-- PAGE Accounts Detail -->
            <div id="page_acc_detail" data-role="page" data-title="Page Accounts Detail">
                <div class="wrapper">

                </div>
            </div>
            <!-- END PAGE Accounts Detail -->
            <!-- PAGE INBOX -->
            <div id="page_inbox" data-role="page" data-title="Page Inbox">
                <div class="wrapper">
                    <ul class="list">
                        <li>
                            <a id="" transition="side" href="#page_myaccount" onclick="openPage(this.href)">
                                <div class="fs1" aria-hidden="true" data-icon="&#xf472;"></div>
                                <strong>Back</strong>
                                <span class=""></span>
                            </a>
                        </li>
                        <li>
                            <a id="" transition="side" href="#page_inbox_detail" onclick="openPage(this.href)">
                                <div class="fs1" aria-hidden="true" data-icon="&#x2407;"></div>
                                <strong>Application No.1238263 Required Docs</strong>

                            </a>
                        </li>
                        <li>
                            <a id="" transition="side" href="#page_inbox_detail" onclick="openPage(this.href)">
                                <div class="fs1" aria-hidden="true" data-icon="&#x2407;"></div>
                                <strong>App No.1238263 Approved</strong>

                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- END PAGE INBOX -->
            <!-- PAGE MANAGE -->
            <div id="page_manage" data-role="page" data-title="Page Manage">
                <div class="wrapper">

                </div>
            </div>
            <!-- END PAGE MANGE -->
            <!-- PAGE POI -->
            <div id="page_poi" data-role="page" data-title="Page Places">
                <div class="wrapper">
                    <div id="srch-bar" style="text-align:center;padding-top: 10px;}">
                        <div class="fs1" aria-hidden="true" data-icon="&#xf472;" style="display: inline-block; margin-right: 20px;font-size: 14pt;" onclick="proxMinus()"></div>
                        <span><input class="" style="width: 80px;border-radius: 50px; text-align: center; font-weight: 700;background-image: URL(images/km-bck.png);background-size:contain;" type="text" id="kmCounter" value="5" /></span>
                        <div class="fs1" aria-hidden="true" data-icon="&#xf473;" style="display: inline-block; margin-left: 20px;font-size: 14pt;" onclick="proxPlus()"></div>
                    </div>
                    <ul class="list">

                        <li>

                            <div class="fs1 poiMenuDiv" aria-hidden="true" data-icon="" style="background-image: url(images/Toll_pin.png);"></div>

                            <strong>Toll Plaza</strong>
                            <span id="tourbtn" class="count" style="margin-right: 100px;">0</span>


                            <div class="toggle-box">
                                <label for="toggle-tolls" class="toggle-label">ON &nbsp;&nbsp; OFF</label>
                                <input type="checkbox" value="1" id="toggle-tolls" class="toggle-control" onclick="setPOI(this.id)">
                            </div>
                        </li>
                        <li>

                            <div class="fs1 poiMenuDiv" aria-hidden="true" data-icon="" style="background-image: url(img/pin/petrol150.png);"></div><!--"\3b"-->
                            <strong>Service Stations</strong>
                            <span id="petbtn" class="count" style="margin-right: 100px;">0</span>

                            <div class="toggle-box">
                                <label for="toggle-petrol" class="toggle-label">ON &nbsp;&nbsp; OFF</label>
                                <input type="checkbox" value="1" id="toggle-petrol" class="toggle-control" onclick="setPOI(this.id)">
                            </div>
                        </li>
                        <li>

                            <div class="fs1 poiMenuDiv" aria-hidden="true" data-icon="" style="background-image: url(img/pin/rest150.png);"></div>
                            <strong>Restaurants</strong>
                            <span id="restbtn" class="count" style="margin-right: 100px;">0</span>

                            <div class="toggle-box">
                                <label for="toggle-rest" class="toggle-label">ON &nbsp;&nbsp; OFF</label>
                                <input type="checkbox" value="1" id="toggle-rest" class="toggle-control" onclick="setPOI(this.id)">
                            </div>
                        </li>
                        <li>

                            <div class="fs1 poiMenuDiv" aria-hidden="true" data-icon="" style="background-image: url(img/pin/events150.png);"></div>
                            <strong>Events</strong>
                            <span id="evebtn" class="count" style="margin-right: 100px;">0</span>

                            <div class="toggle-box">
                                <label for="toggle-events" class="toggle-label">ON &nbsp;&nbsp; OFF</label>
                                <input type="checkbox" value="1" id="toggle-events" class="toggle-control" onclick="setPOI(this.id)">
                            </div>
                        </li>
                        <li>

                            <div class="fs1 poiMenuDiv" aria-hidden="true" data-icon="" style="background-image: url(img/pin/activity150.png);"></div>
                            <strong>Activities</strong>
                            <span id="activebtn" class="count" style="margin-right: 100px;">0</span>

                            <div class="toggle-box">
                                <label for="toggle-activ" class="toggle-label">ON &nbsp;&nbsp; OFF</label>
                                <input type="checkbox" value="1" id="toggle-activ" class="toggle-control" onclick="setPOI(this.id)">
                            </div>
                        </li>
                        <li>

                            <div class="fs1 poiMenuDiv" aria-hidden="true" data-icon="" style="background-image: url(img/pin/accomodation150.png);"></div>
                            <strong>Accomodation</strong>
                            <span id="accbtn" class="count" style="margin-right: 100px;">0</span>

                            <div class="toggle-box">
                                <label for="toggle-accom" class="toggle-label">ON &nbsp;&nbsp; OFF</label>
                                <input type="checkbox" value="1" id="toggle-accom" class="toggle-control" onclick="setPOI(this.id)">
                            </div>
                        </li>
                        <li>

                            <div class="fs1 poiMenuDiv" aria-hidden="true" data-icon="" style="background-image: url(img/pin/retail150.png);"></div>
                            <strong>Retail</strong>
                            <span id="retbtn" class="count" style="margin-right: 100px;">0</span>

                            <div class="toggle-box">
                                <label for="toggle-retail" class="toggle-label">ON &nbsp;&nbsp; OFF</label>
                                <input type="checkbox" value="1" id="toggle-retail" class="toggle-control" onclick="setPOI(this.id)">
                            </div>
                        </li>
                        <li style="padding: 8px;">
                            <div style="text-align:center;" id="longlatXX">...</div>
                        </li>
                        <li onclick="runpoi()">
                            <!--<a id="srch" transition="side" href="#page_location_map" onclick="runpoi()">-->
                            <div id="srch" class="fs1" aria-hidden="true" data-icon="&#xf473;"></div>
                            <strong>Search</strong>
                            <span class=""></span>
                            </a>
                        </li>
                    </ul>


                    <ul id="poiList" class="poilist">
                        <li></li>
                    </ul>
                </div>
            </div>
            <!-- END PAGE MANGE -->
            <!-- PAGE TWITTER -->
            <div id="page_twitter" data-role="page" data-title="Page Twitter">
                <div class="wrapper">
                    <iframe frameborder="0" id="formFrm" style=" width:100%;" src="twitter/map/index-twtmap.html"></iframe>
                    <!-- <ul id="list-tweets" class="list"></ul>
                    <a class="twitter-timeline" href="https://twitter.com/N3Route">Tweets by N3Route</a>
                    <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>-->
                </div>
            </div>
            <!-- END PAGE TWITTER -->
            <!-- PAGE FETCH TWITTER -->
            <div id="page_twitter_fetch" data-role="page" data-title="Page Twitter Fetch">
                <div class="wrapper">
                    <div id="CrashUpdate" style="border-top: 15px solid #f1f1f1;"></div>
                    <div id="N3TollRoute" style="border-bottom: 25px solid #f1f1f1;"></div>
                </div>
            </div>
            <!-- END PAGE FETCH TWITTER -->
            <!-- PAGE Iframe -->
            <div id="page_myaccountXX" data-role="page" data-title="Page My Accountxx">
                <div class="wrapper">

                    <!-- <iframe frameborder="0" id="formFrmXX" style=" width:100%;" src="assets/cda_appform.html"></iframe>-->
                </div>
            </div>
            <!-- END PAGE iframe -->
            <!-- PAGE SAVE LOCATION -->
            <div id="page_save_location" data-role="page" data-title="Page Save Location">
                <div class="bar-standard bar-header-secondary">
                    <a class="button-block" href="#page_location_map_trip" onclick="openPage(this.href)">Add New Trip</a>
                </div>
                <div class="wrapper-bar">
                    <ul id="list-save-location" class="list"></ul>
                </div>

            </div>
            <!-- END PAGE SAVE LOCATION -->
            <!-- PAGE DETAIL SAVE LOCATION -->
            <div id="page_detail_save_location" data-role="page" data-title="Page Detail Save Location">
                <div class="wrapper">
                    <div class="input-group">
                        <div class="input-row">
                            <label>Date</label>
                            <div id="date-save-location"></div>
                        </div>
                        <div class="input-row">
                            <label>Location</label>
                            <!--<input type="text" id="form-title" placeholder="Title">-->
                            <div id="address-save-location"></div>
                        </div>
                        <div class="input-row">
                            <label>Title</label>
                            <div id="title-save-location"></div>
                        </div>
                        <div class="input-row">
                            <label>Description</label>
                            <div id="desc-save-location"></div>
                        </div>
                    </div>
                    <div class="content-padded">
                        <div id="button-save-location"></div>
                        <div id="button-save-location2">
                            <a class="button-positive button-block" href="#page_save_location">Saved Trips</a>
                            
                        </div>
                    </div>
                </div>
            </div>
            <!-- END PAGE DETAIL SAVE LOCATION -->
            <!-- PAGE ADD LOCATION -->
            <div id="page_add_location" data-role="page" data-title="Page Save Location">
                <div class="content-padded">
                
                
                    <form>
                        <input type="text" id="form-title" placeholder="Title">
                        <textarea rows="5" id="form-desc" placeholder="Description"></textarea>
                        <a id="form-add" class="button-positive button-block" href="#page_save_location" onclick="openPage(this.href)">Add Trip</a>
                        <span id="tripCoords" class="count">x</span>
                        <span id="show-location-address" class="count">Location</span>

                    </form>


                </div>
                
            </div>
            <!-- END PAGE ADD LOCATION -->
            <!-- PAGE LOCATION MAP-->
            <div id="page_location_map" data-role="page" data-title="Page Location Map">
                <div id='mapcont' data-snap-ignore="true"></div>

                <div id="map_canvas" style="width: 100%;" data-snap-ignore="true"></div>

            </div>
            <!-- END PAGE LOCATION MAP-->
            <!-- PAGE LOCATION MAPTRIP-->
            <div id="page_location_map_trip" data-role="page" data-title="Page Location Map">
                <iframe frameborder="0" id="frameTrip" scrolling="yes" style=" width:100%;" src="assets/testmapn3.html"></iframe>

            </div>
            <!-- END PAGE LOCATION MAPTIRP-->
            <!-- PAGE DETAIL LOCATION -->
            <div id="page_show_location" data-role="page">
                <nav class="bar-standard">
                    <ul class="segmented-controller">
                        <li><a id="btn-show-map" href="#">Map</a></li>
                        <li><a id="btn-show-street" href="#">Street</a></li>
                        <li><a id="btn-show-directions" href="#">Directions</a></li>
                        <li><a id="btn-show-route" href="#">Route</a></li>
                    </ul>
                </nav>
                <div class="wrapper-bar">
                    <div class="slider" data-snap-ignore="true">

                        <ul id="show-images">
                            <li><img src="img/pin/twt-sign1.png" width="auto" height="100%" /></li>
                            <li><img src="img/pin/twt-sign1.png" width="auto" height="100%" /></li>
                            <li><img src="img/pin/twt-sign1.png" width="auto" height="100%" /></li>
                            <li><img src="img/pin/twt-sign1.png" width="auto" height="100%" /></li>

                        </ul>
                    </div>
                    <div class="input-group">
                        <div class="input-row">
                            <label>Category</label>
                            <div id="title-show-category"></div>
                        </div>
                        <div class="input-row">
                            <label>Name</label>
                            <div id="title-show-name"></div>
                        </div>
                        <div class="input-row">
                            <label>Phone</label>
                            <div id="title-show-phone"></div>
                        </div>
                        <div class="input-row">
                            <label>Url</label>
                            <div id="title-show-url"></div>
                        </div>
                        <div class="input-row">
                            <label>Address</label>
                            <div id="title-show-address"></div>
                        </div>
                        <div class="input-row">
                            <label>Description</label>
                            <div id="title-show-desc"></div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- END PAGE DETAIL LOCATION -->
            <!-- PAGE LOCATION ROUTE -->
            <div id="page_location_route" data-role="page" data-title="Page Location Route">
                <div class="content-padded" data-snap-ignore="true">
                    <div class="wrapper-route">
                        <div id="directions-route"></div>
                    </div>
                </div>
            </div>
            <!-- END PAGE LOCATION ROUTE-->

        </div>
        <!-- END CONTENT -->
    </div>
    <!-- END MAIN -->

    <script type="text/javascript" src="js/snap.min.js"></script>
    <script type="text/javascript" src="js/app.js"></script>

    <script type="text/javascript" src="js/points.js"></script>
    <script type="text/javascript" src="js/poirun.js"></script>

    <script type="text/javascript" src="js/myTrips.js"></script>

    <script src="js/twtfetch.js"></script>



    <script>
        function openPage(href) {
            var idref = href;
            window.location.href = idref;
            //  jqUpdateSize();
            screenHeight();
            $('.loading').hide();
            $('.mapboxgl-ctrl-geocoder').hide();
            //getLocationCategory();
            //var el = document.getElementById('save-location');
            // el.setAttribute('disabled', 'disabled');
            // $("#topHead").html("dised..");
            //map.resize();
            setTimeout(function () { map.resize(); }, 300);
        };

        function openPageExt() {
            screenHeight();
            var idref2 = 'assets/cda_appform.html';
            window.location.href = idref2;

        };
        function openPageAcc(href) {
            var chkAthnav = localStorage.getItem("Authcheck");
          
            screenHeight();
            var idrefAcc = href;
            window.location.href = idrefAcc;

        };
        function openPageLocmap(href) {
            //  var chkAthnav = localStorage.getItem("Authcheck");
             //$('#frameTrip').src ='assets/testmapn3.html';
            screenHeight();
            var idrefLocmap = href;
            window.location.href = idrefLocmap;

        };

        function openPageFly(href) {
            screenHeight();
            var idrefAcc = href;
            window.location.href = idrefAcc;
            flyN3Route();

        };

        function openTwtPage() {
            window.location = '#page_twitter_fetch';

        };

        function toggleSrch() {
            $('.mapboxgl-ctrl-geocoder').show();
            $('.mapboxgl-ctrl-directions').hide();
            $('.mapboxgl-ctrl-top-right').show();
        };

        var sHeight = '';
        var frmHeight = '';
        //adjust screen size
        function screenHeight() {
            sHeight = $(window).height();
            frmHeight = sHeight - 50;
            $("#formFrm").attr("height", frmHeight);
            $("#frameForm").attr("height", sHeight + 50);
            $("#frameTrip").attr("height", frmHeight);
            //alert(sHeight + 'px');

        };
    </script>


    <script>

        //Toll markers
        var geojsonToll = {
            "type": "FeatureCollection",
            "features": [{
                "type": "Feature",
                "properties": {
                    "title": "Tugela Mainline",
                    "imageUrl": "https://pbs.twimg.com/profile_images/886116557105049600/ljd_Cnos_400x400.jpg",
                    "type": "beach",
                    "iconSize": [60, 60]
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [29.56157, -28.4625]
                }
            }, {
                "type": "Feature",
                "properties": {
                    "title": "Bergville Ramp",
                    "imageUrl": "https://c1.staticflickr.com/5/4379/36844732181_78bd19e9eb_q.jpg",
                    "type": "beach",
                    "iconSize": [50, 50]
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [29.60895, -28.58687]
                }
            }, {
                "type": "Feature",
                "properties": {
                    "title": "Mooi Local Ramp (N)",
                    "imageUrl": "https://c1.staticflickr.com/5/4348/36844765631_03e90607bd_q.jpg",
                    "type": "beach",
                    "iconSize": [40, 40]
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [29.99377, -29.19301]
                }
            }, {
                "type": "Feature",
                "properties": {
                    "title": "Mooi Mainline",
                    "imageUrl": "https://c1.staticflickr.com/5/4333/36825444362_4291ce6d1e_q.jpg",
                    "type": "city",
                    "iconSize": [40, 40]
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [30.00389, -29.21795]
                }
            }, {
                "type": "Feature",
                "properties": {
                    "title": "Mooi Local Ramp (S)",
                    "imageUrl": "https://c1.staticflickr.com/5/4347/36857337771_d1bb7f798a_q.jpg",
                    "type": "jungle",
                    "iconSize": [40, 40]
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [30.00448, -29.22157]
                }
            }, {
                "type": "Feature",
                "properties": {
                    "title": "Wilge Mainline",
                    "imageUrl": "https://c1.staticflickr.com/5/4421/36997408855_bfdb9f1fba_q.jpg",
                    "type": "mountain"
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [28.62628, -27.04038]
                }
            }, {
                "type": "Feature",
                "properties": {
                    "title": "De Hoek Mainline",
                    "imageUrl": "https://c1.staticflickr.com/5/4388/36837224452_98940aa9e4_q.jpg",
                    "type": "city"
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [28.38988, -26.66397]
                }
            }, {
                "type": "Feature",
                "properties": {
                    "title": "Mariannhill Mainline",
                    "imageUrl": "https://c1.staticflickr.com/5/4357/36172707494_2b8ea05f04_q.jpg",
                    "type": "city"
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [30.80275, -29.823006]
                }
            }, {
                "type": "Feature",
                "properties": {
                    "title": "Tugela East Ramp",
                    "imageUrl": "https://c1.staticflickr.com/5/4390/36837410552_fbeb6d1cdc_q.jpg",
                    "type": "beach"
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [29.569956, -28.458096]
                }
            }, {
                "type": "Feature",
                "properties": {
                    "title": "Treverton Ramp",
                    "imageUrl": "https://c1.staticflickr.com/5/4390/36837410552_fbeb6d1cdc_q.jpg",
                    "type": "beach"
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [29.993112, -29.193292]
                }
            }]
        };

        //small map slider add
        mapboxgl.accessToken = 'pk.eyJ1IjoiZ3JlZ2RpeDEiLCJhIjoiY2o2YXR2dGs0MWF1cjJxcGt2Njkyb3Q3OCJ9.YvaAQsUYmPfOG36iVUZGyQ';
        var map2 = new mapboxgl.Map({
            container: 'mapSlider', // container id
            style: 'mapbox://styles/mapbox/streets-v9',
            center: [28.961877, -27.890197], // starting position
            zoom: 6 // starting zoom
        });

        mapboxgl.accessToken = 'pk.eyJ1IjoiZ3JlZ2RpeDEiLCJhIjoiY2o2YXR2dGs0MWF1cjJxcGt2Njkyb3Q3OCJ9.YvaAQsUYmPfOG36iVUZGyQ';
        var map = new mapboxgl.Map({
            container: 'map_canvas', // container id
            style: 'mapbox://styles/mapbox/streets-v9',
            center: [29.217650, -27.713353], // starting position
            zoom: 6 // starting zoom
        });


        function AddTollMarkers() {
            // add Toll markers to map
            geojsonToll.features.forEach(function (marker) {
                // create a DOM element for the marker
                var el = document.createElement('div');
                el.className = 'marker';
                // el.style.backgroundImage = 'url(images/Toll_pin.png)';
                el.style.backgroundImage = 'url(img/pin/tollcup150.png)';
                el.style.backgroundSize = 'contain';
                // el.style.width = marker.properties.iconSize[0] + 'px';
                // el.style.height = marker.properties.iconSize[1] + 'px';
                el.style.width = '30px';
                el.style.height = '30px';
                var titleTxt = marker.properties.title;
                el.innerHTML = '<span class="markerLbl">' + titleTxt + '</span>';

                el.addEventListener('click', function () {
                    //window.alert(marker.properties.message);
                });

                // add marker to maps
                new mapboxgl.Marker(el)
                    .setLngLat(marker.geometry.coordinates)
                    .addTo(map2);
                // .addTo(map2);
            });

        };

        //local set N3 route
        function addRouteLocal() {

            flyN3();


            map2.addLayer({
                id: 'routeN3',
                type: 'line',
                source: {
                    type: 'geojson',
                    data: {
                        type: 'Feature',
                        properties: {},
                        geometry: {
                            type: "LineString",
                            coordinates: [
                                //  [28.026304, -26.16668],
                                //  [28.032338, -26.21171],
                                //  [28.13606, -26.211772],
                                //  [28.156642, -26.294383],
                                [28.380304, -26.497302],
                                [28.401415, -26.702917],
                                [28.758794, -27.269274],
                                [28.84372, -27.577899],
                                [28.950695, -27.736669],
                                [28.988801, -28.008842],
                                [29.134796, -28.29303],
                                [29.558688, -28.454024],
                                [29.64719, -28.736327],
                                [29.822358, -29.021836],
                                [29.921372, -29.06684],
                                [30.05096, -29.32345],
                                [30.217006, -29.506893],
                                // [30.394778, -29.588352]
                                [30.80275, -29.823006]


                            ]
                        }
                    }
                },
                paint: {
                    'line-width': 8,
                    'line-color': '#3bb2d0',
                    'line-opacity': 0.8
                }
            });
            map2.addLayer({
                id: 'startN3',
                type: 'circle',
                paint: {
                    'circle-radius': 10,
                    'circle-color': '#3bb2d0'
                },
                source: {
                    type: 'geojson',
                    data: {
                        type: 'Feature',
                        geometry: {
                            type: 'Point',
                            coordinates: [28.380304, -26.497302]

                        }
                    }
                }
            });
            map2.addLayer({
                id: 'endN3',
                type: 'circle',
                paint: {
                    'circle-radius': 10,
                    'circle-color': '#3bb2d0'
                },
                source: {
                    type: 'geojson',
                    data: {
                        type: 'Feature',
                        geometry: {
                            type: 'Point',
                            coordinates: [30.80275, -29.823006] //[30.394778, -29.588352]
                        }
                    }
                }
            });
        };




        var url = 'https://wanderdrone.appspot.com/';
        var trackState = 0;
        function trackOn() {
            var trackInt = window.setInterval(function () {
                map.getSource('drone').setData(url); trackState = 1;
            }, 2000);

            map.addSource('drone', { type: 'geojson', data: url });
            map.addLayer({
                "id": "drone",
                "type": "symbol",
                "source": "drone",
                "layout": {
                    "icon-image": "rocket-15"
                }
            });

            if (trackState == 1) { clearInterval(trackInt); trackState = 0; }
        };


        function addDirections() {
            $('.mapboxgl-ctrl-geocoder').hide();
            $('.mapboxgl-ctrl-top-right').hide();
            $('.mapboxgl-ctrl-directions').show();
            //  Directions controller
            map.addControl(new MapboxDirections({
                accessToken: mapboxgl.accessToken,
                unit: 'metric',
            }), 'top-left');




        };


        var rtPoints = '';
        ///geocoder
        var geocoder = new MapboxGeocoder({
            accessToken: mapboxgl.accessToken
        });

        map.addControl(geocoder);

        // Add geolocate control to the map.
        map.addControl(new mapboxgl.GeolocateControl({
            positionOptions: {
                enableHighAccuracy: true
                //timeout: 3000
            },
            trackUserLocation: true
        }));

        //toggle tracking
        function navOn() {
            if (trackUserLocation) {
                trackUserLocation: false;
                document.getElementById('toggle-active-nav').className = ('toggle-control:checked');
            } else {
                trackUserLocation: true;
            }
        };

        // Add zoom and rotation controls to the map.
        map.addControl(new mapboxgl.NavigationControl());



        map.addControl(geocoder);

        function toggleMyGeocoder() {
            //alert("tt");
        };

        function addPorts() {
            // Add Ports from json
            map.addSource('ports1', {
                type: 'geojson',
                data: 'data/ne_10m_ports.json'
            });
        }

        $('.mapboxgl-ctrl-geocoder').hide();
        // After the map style has loaded on the page, add a source layer and default
        // styling for a single point.
        map.on('load', function () {
            $('.loading').hide();

            //showRoute();

            map.addLayer({
                "id": "point",
                "source": "single-point",
                "type": "circle",
                "paint": {
                    "circle-radius": 10,
                    "circle-color": "#007cbf"
                }
            });

        });
        // mapX.addSource('single-point', {
        //     "type": "geojson",
        //     "data": {
        //        "type": "FeatureCollection",
        //        "features": []
        //    }
        //  });



        map2.on('load', function () {

            //addRouteLocal();
            setTimeout(function () { addRouteLocal(); }, 4000);
            // AddTollMarkers();
        });






        // Listen for the `geocoder.input` event that is triggered when a user
        // makes a selection and add a symbol that matches the result.
        geocoder.on('result', function (ev) {
            map.getSource('single-point').setData(ev.result.geometry);

            var evstr = JSON.stringify(ev.result.geometry);
            alert("mygeo ev" + evstr);
        });

        ///watch position START

        var id, target, options;

        function success(pos) {
            var crd = pos.coords;

            if (target.latitude === crd.latitude && target.longitude === crd.longitude) {
                console.log('Congratulations, you reached the target');
                navigator.geolocation.clearWatch(id);
            }
        }

        function error(err) {
            console.warn('ERROR(' + err.code + '): ' + err.message);
        }

        target = {
            latitude: 0,
            longitude: 0
        };

        options = {
            enableHighAccuracy: false,
            timeout: 5000,
            maximumAge: 0,
            active: true
        };

        id = navigator.geolocation.watchPosition(success, error, options);

        ///END WATCH

        //fly to location
        // fly with default options to null island
        function flytoCent(lat, lon) {
            map.flyTo({ center: [0, 0], zoom: 9 });
        };

        // using flyTo options
        function flytoZoom() {
            map.flyTo({
                center: [31.0004528167874, -29.87049356975689],
                zoom: 9,
                speed: 0.2,
                curve: 1,
                // easing(t) {
                //    return t;
                // }
            });
        }

        //end fly

        function addTolls() {

            var tollMarker = new mapboxgl.Marker()
                .setLngLat([-28.4625, 29.56157])
                .addTo(map);
        }

        ///poi
        function myLoc() {


            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition, errorGettingPosition);


            } else {
                // document.getElementById("demo").innerHTML = "Geolocation is not supported by this browser.";
                alert("Please enable your GPS on your device");
            }

            function showPosition(position) {

                mylat = position.coords.latitude;
                mylon = position.coords.longitude;
                //below for maps-gbd.js scripts etc...
                mylong = position.coords.longitude;
                // alert(mylat + mylon + "tracking onm");
                document.getElementById("gpsout").innerHTML = "Lat: " + mylat + "  Lon: " + mylon;
                // map.setCenter([mylon, mylat]);
                // map2.flyTo({ center: [mylon, mylat], zoom: 17 });
                map.flyTo({ center: [mylon, mylat], zoom: 11 });
            }
        };

        function errorGettingPosition(err) {
            return err;
            if (err.code == 1) {
                //alert("User denied geolocation.");
                document.getElementById("gpsout").innerHTML += "Cannot detect GPS. Please enable your GPS location feature" + "<br><div onClick='gpsEnabled()' style=' background-color: #4b80ac; display:inline-block; padding: 5px;  border-radius: 50px; margin: 15px; border: solid 1px #fff;'>MY GPS IS NOW ENABLED</div><div onClick='gpsIgnore()' style=' background-color: #4b80ac; display:inline-block; padding: 5px;  border-radius: 50px; margin: 15px; border: solid 1px #fff;'>IGNORE GPS</div>";
            }
            else if (err.code == 2) {
                //alert("Position unavailable.");
                document.getElementById("gpsout").innerHTML += "<br>" + "Position unavailable";
            }
            else if (err.code == 3) {
                alert("Timeout expired.");
            }
            else {
                alert("ERROR:" + err.message);
                document.getElementById("gpsout").innerHTML = err.message;

            }
        };

        var bounds;
        ///SHow route N3
        document.getElementById("li_page_nearby").addEventListener('click', function () {

            window.location.href = "#page_location_map";
        });
        // bounds = [[32.958984, -5.353521], [43.50585, 5.615985]];
        function setBoundsn3() {
            map.fitBounds([[
                32.958984,
                -5.353521
            ], [
                43.50585,
                5.615985
            ]]);

        };



    </script>

    <script>

        document.addEventListener("deviceready", onDeviceReady, false);
        function onDeviceReady() {
            console.log(device.cordova);
            var model = device.model;
            var devPlatform = device.platform;
            var deviceID = device.uuid;
            var deviceVersion = device.version;
            var manu = device.manufacturer;
            var deviceSerial = device.serial;

            var devSpec = 'mod: ' + model + ' Plat: ' + devPlatform + ' uuid: ' + deviceID + ' ver: ' + deviceVersion + ' Manufac: ' + manu + ' serial: ' + deviceSerial;
            document.getElementById("n3tc-banner").innerHTML += devSpec;
            localStorage.setItem("deviceSpec", devSpec);

            // cordova.dialogGPS("hello world",function(buttonIndex) {
            //do something with the buttonIndex
            // });
        }

        //flyN3
        function flyN3() {
            map2.flyTo({
                center: [30.2518344, -29.8823032],
                pitch: 60, // pitch in degrees
                bearing: -10, // bearing in degrees
                zoom: 7,
                speed: 0.8,
                curve: 1,
                easing(t) {
                    return t
                }
            });

            AddTollMarkers();

        };
    </script>

    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript">
        app.initialize();
    </script>

</body>

</html>
